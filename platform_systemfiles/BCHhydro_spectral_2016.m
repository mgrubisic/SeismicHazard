function [rho] = BCHhydro_spectral_2016(T1, T2,~)

% Abrahamson, N., Gregor, N., & Addo, K. (2012). BC Hydro Ground Motion 
% Prediction Equations for Subduction Earthquakes. Earthquake Spectra.%

% National Research Center for Integrated Natural Disaster Management
% CONICYT/FONDAP/15110017. FONDECYT N° 1170836 “SIBER-RISK: SImulation
% Based Earthquake Risk and Resilience of Interdependent Systems and NetworKs

T1(and(T1>=0,T1<0.01))=0.01;
T1(and(T1>=0,T1<0.01))=0.01;

T_min = min(T1, T2); 
T_max = max(T1, T2); 
V     = interfaceBin1();
T     = [0.01;0.05; 0.075;0.10; 0.15; 0.20; 0.25; 0.30; 0.40; 0.50; 0.60; 0.75; 1.0; 1.5;  2.0;  2.5;  3.0;  4.0;  5.0  ];
[X,Y] = meshgrid(T);
rho   = interp2(X,Y,V,T_min,T_max,'spline');
rho(T_min==T_max)=1;
rho   = min(rho,1);
rho   = max(rho,min(V(:)));

rho(T_min<0.01) = nan;
rho(T_max>5)   = nan;

function V=interfaceBin1()
V=[1.000 0.959 0.938 0.930 0.930 0.910 0.887 0.858 0.817 0.729 0.648 0.580 0.464 0.391 0.309 0.274 0.280 0.223 0.231
0.959 1.000 0.971 0.942 0.900 0.855 0.820 0.783 0.717 0.634 0.548 0.477 0.409 0.300 0.218 0.203 0.187 0.149 0.168
0.938 0.971 1.000 0.968 0.909 0.849 0.798 0.754 0.680 0.584 0.498 0.427 0.353 0.247 0.175 0.162 0.156 0.121 0.135
0.930 0.942 0.968 1.000 0.935 0.874 0.806 0.753 0.699 0.576 0.487 0.416 0.284 0.230 0.167 0.146 0.162 0.112 0.131
0.930 0.900 0.909 0.935 1.000 0.934 0.870 0.812 0.725 0.624 0.536 0.464 0.384 0.269 0.190 0.175 0.171 0.140 0.147
0.910 0.855 0.849 0.874 0.934 1.000 0.941 0.885 0.810 0.700 0.614 0.535 0.419 0.326 0.278 0.228 0.245 0.181 0.184
0.887 0.820 0.798 0.806 0.870 0.941 1.000 0.952 0.860 0.766 0.679 0.598 0.503 0.383 0.301 0.276 0.256 0.225 0.220
0.858 0.783 0.754 0.753 0.812 0.885 0.952 1.000 0.917 0.826 0.743 0.664 0.564 0.437 0.354 0.328 0.301 0.269 0.255
0.817 0.717 0.680 0.699 0.725 0.810 0.860 0.917 1.000 0.921 0.843 0.762 0.627 0.531 0.433 0.412 0.371 0.332 0.306
0.729 0.634 0.584 0.576 0.624 0.700 0.766 0.826 0.921 1.000 0.939 0.864 0.756 0.616 0.522 0.483 0.436 0.392 0.364
0.648 0.548 0.498 0.487 0.536 0.614 0.679 0.743 0.843 0.939 1.000 0.931 0.818 0.682 0.581 0.532 0.481 0.436 0.400
0.580 0.477 0.427 0.416 0.464 0.535 0.598 0.664 0.762 0.864 0.931 1.000 0.904 0.772 0.677 0.624 0.571 0.526 0.498
0.464 0.409 0.353 0.284 0.384 0.419 0.503 0.564 0.627 0.756 0.818 0.904 1.000 0.879 0.777 0.729 0.671 0.629 0.586
0.391 0.300 0.247 0.230 0.269 0.326 0.383 0.437 0.531 0.616 0.682 0.772 0.879 1.000 0.924 0.866 0.816 0.754 0.709
0.309 0.218 0.175 0.167 0.190 0.278 0.301 0.354 0.433 0.522 0.581 0.677 0.777 0.924 1.000 0.947 0.901 0.846 0.798
0.274 0.203 0.162 0.146 0.175 0.228 0.276 0.328 0.412 0.483 0.532 0.624 0.729 0.866 0.947 1.000 0.965 0.901 0.861
0.280 0.187 0.156 0.162 0.171 0.245 0.256 0.301 0.371 0.436 0.481 0.571 0.671 0.816 0.901 0.965 1.000 0.946 0.906
0.223 0.149 0.121 0.112 0.140 0.181 0.225 0.269 0.332 0.392 0.436 0.526 0.629 0.754 0.846 0.901 0.946 1.000 0.961
0.231 0.168 0.135 0.131 0.147 0.184 0.220 0.255 0.306 0.364 0.400 0.498 0.586 0.709 0.798 0.861 0.906 0.961 1.000];
